<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="POPPRO是由Crypton Future Media公司官方独家授权的初音未来官方中文投稿网站。" />
    <title>POPPRO | 发表作品</title>
    <link rel="shortcut icon" href="../images/favicon.ico"/>
    <link type="text/css" href="../css/dropkick.css" rel="stylesheet" />
    <link type="text/css" href="../css/b.css" rel="stylesheet" /><link type="text/css" href="../css/b_v2.css" rel="stylesheet" />
    <link type="text/css" href="../css/post.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="../css/uploadify.css">
    <link type="text/css" href="../js/layer/skin/default/layer.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="../css/uploadify.css">
	<link type="text/css" href="../js/layer/skin/default/layer.css" rel="stylesheet" />  
	<link rel="stylesheet" href="../css/jquery.Jcrop.min.css" type="text/css" />  
	<link rel="stylesheet" type="text/css" href="../css/uploadifive.css">
</head>
<body class="mainbody">
<div class="headerbody">
<div class="header wp">
    <h1 class="logo"><img src="../images/logo.png"></h1>
    <div class="searchbox">
        <div class="searchboxbody">
            <a class="select" href="javascript:;" id="search-select"><img src="../images/search-ico-1-on.jpg" id="search-select-1"><img src="../images/search-ico-2-on.jpg" style="display: none"  id="search-select-2"><img src="../images/search-ico-3-on.jpg" style="display: none"  id="search-select-3"><img src="../images/search-ico-5-on.png" style="display: none"  id="search-select-4"><img src="../images/search-ico-6-on.png" style="display: none"  id="search-select-5"></a>
            <input type="text" class="input" placeholder="初音">
            <input type="button" class="btn">
        </div>
        <ul id="search-type">
            <li><a href="javascript:;" class="on" id="search-type-1"><img src="../images/search-ico-1.jpg" class="imgunon"><img src="../images/search-ico-1-on.jpg" class="imgon">音乐</a></li>
            <li><a href="javascript:;" id="search-type-3"><img src="../images/search-ico-3.jpg" class="imgunon"><img src="../images/search-ico-3-on.jpg" class="imgon">图片／3D</a></li>
            <li><a href="javascript:;" id="search-type-2"><img src="../images/search-ico-2.jpg" class="imgunon"><img src="../images/search-ico-2-on.jpg" class="imgon">文字</a></li>
                <li><a href="javascript:;" id="search-type-4"><img src="../images/search-ico-5.png" class="imgunon"><img src="../images/search-ico-5-on.png" class="imgon">用户</a></li>
                <li><a href="javascript:;" id="search-type-5"><img src="../images/search-ico-6.png" class="imgunon"><img src="../images/search-ico-6-on.png" class="imgon">小组</a></li>
        </ul>
    </div>
    <ul class="top-login">
                 <li><a href="message.html" class="t-msg-link" style='display:none;'>消息<span>3</span></a></li>
        <li></li>
        <li><a href="post-music.html" class="t-send-link">我要投稿</a></li>
    </ul>
</div>
</div><div class="navbox"><ul class="wp">
        <li><a href="main.html">首页</a></li>
        <li><a href="list-music.html"  class="on">音乐</a></li>
        <li><a href="list-img.html">画作／3D 建模</a></li>
        <li><a href="list-txt.html">文字作品</a></li>     
        <li><a href="activity.html">专题活动</a></li>
        <li><a href="groups.html">小组创作</a></li><li><a href="/html/list-hudong.html">官方互动</a></li>
       
    </ul>
</div>
<div class="post-top">
    <h3 class="post-title"><span></span></h3>
    <ul>
        <li><a href="post-music.html" class="on">音乐上传</a></li>
        <li><a href="post-image.html">画作/3D 建模上传</a></li>
        <li><a href="post-txt.html">文字上传</a></li>
    </ul>
</div>
<div class="post-main">
    <div class="post-l">
        <div class="post-form">
            <h3>作品标题<span id="titlebox-count"><i>0</i>/30</span></h3>
            <div class="formbox"><input name="title" type="text" placeholder="请输入标题" class="input-1" id="titlebox"></div>
            <h3>作品上传</h3>
            <div class="upload-music-box">
                <h4>上传音乐</h4>
                <p>音乐文件为mp3格式，大小不超过20M</p>
<!--                 <a class="btn" href="javascript:;">选择文件</a>未选择任何文件
 -->                <div id="queue"></div>
                <input id="file_upload" name="file_upload" class="btn" type="file">
                <input id="file_upload_h5" style="display:none" name="file_upload_h5" type="file" multiple="true">
                <span class="h5_file_name"></span>
            </div>
            <h3>作品分类</h3>
            <div class="formbox clearfix">
                <div class="allselect">
                <select class="select-1 cat allselect catMusic cat" id="selectbox-1">
                </select>
                </div>
            </div>
            <h3>作品歌词</h3>
            <div class="formbox">
                <textarea rows="" cols="" placeholder="快来编辑一下歌词吧" class="textarea-2 lyric" id="textarea-2" ></textarea>
                <p><span id="lyricbox-count"><i>0</i>/500</span></p>
            </div>
            <h3>作品描述</h3>
            <div class="formbox">
                <textarea rows="" cols="" placeholder="快来介绍一下你的作品吧！" class="textarea-1 workDesc" id="textarea-1" ></textarea>
                <p><span id="descbox-count"><i>0</i>/500</span></p>
            </div>
            <h3>作品标签</h3>
            <div class="tagsbox">
                <dl class="tagMan">
                    <dt>人物标签</dt>
                </dl>
                <dl class="tagUse">
                </dl>
                <dl>
                    <dt>自定义标签</dt>
                    <dd>
                        <input type="text" class="input-1" placeholder="请输入自定义标签"><input type="button" class="add-btn" value="添加">
                    </dd>
                </dl>
            </div>
            <h3>发布规则</h3>
            <div class="formbox auth authGuize">
            <p>授权许可条件</p>
            <div class="sqbox">
                <ul>
                    <li>
                        <img src="../images/post-e1.png">
                        <dl>
                            <dt>仅限非营利使用</dt>
                            <dd><input type="radio" checked="checked" name="authCondition"><label>是</label></dd>
                        </dl>
                    </li>
                    <li>
                        <img src="../images/post-e2.png">
                        <dl>
                            <dt>是否需要署名</dt>
                            <dd><input type="radio" checked="checked" name="authSignatureNeed"><label>需要</label><input name="authSignature" type="text" class="txt-1" placeholder="请输入名字，20个字以内" maxlength="20"></dd>
                            <dd><input type="radio" name="authSignatureNeed"><label>不需要</label></dd>
                        </dl>
                    </li>
                    <li>
                        <img src="../images/post-e3.png">
                        <dl>
                            <dt>是否允许改动作品</dt>
                            <dd><input type="radio" checked="checked" name="authModify"><label>允许</label></dd>
                            <dd><input type="radio" name="authModify"><label>不允许</label></dd>
                        </dl>
                    </li>
                    <li>
                        <img src="../images/post-e4.png">
                        <dl>
                            <dt>是否有其他要求</dt>
                            <dd><input type="radio" checked="checked" name="authRequireNeed"><label>有</label><input name="authRequire" type="text" class="txt-2" placeholder="请输入要求，20个字以内" maxlength="20"></dd>
                            <dd><input type="radio" name="authRequireNeed"><label>没有</label></dd>
                        </dl>
                    </li>
                </ul>
            </div>
            <p><input name="auth" type="checkbox" class="checkbox-1" >没有授权许可条件</p>
            </div>

            <div class="post-btn-box">
                <a href="javascript:uploadMusic();">发布</a>
            </div>
        </div>
    </div>
     <div class="flagbox-1">
        <h3>作品封面</h3>
        <div class="imgbox"><img src=""> </div>
        <p class="flagbox-1-tip">缩略图支持jpg、png、gif，不超过2M</p>
        <input id="file_upload_pic" name="file_upload" type="file" multiple="true">
        <input id="file_upload_pic_h5" style="display:none" name="file_upload_pic_h5" type="file" multiple="true">
        <span class="arrw"></span>
    </div>
    <div class="flagbox-2 tagList" style="top:1230px;">
        <h3>已选标签<span>0/10</span></h3>
        <ul>

        </ul>
        <span class="arrw"></span>
    </div>
</div>
<div class="footer">
    <div class="footer-body">
        <h2>
            <img src="../images/logo-footer.png">
        </h2>
        <ul class="footer-ico-box">
            <li class="footer-ico-1">
                <h3>官方微信</h3>
                <p>关注POPPRO最新动态</p>
            </li>
            <li class="footer-ico-2">
                <h3>初音未来 V4 中文版</h3>
                 <p><a target="_blank" style="text-decoration:none; color:#b0b0b2; " href="https://item.taobao.com/item.htm?spm=a230r.1.14.21.108f93131LkcYB&id=557546981640&ns=1&abbucket=1#detail" >点击购买</a></p>
            </li>
        </ul>
        <div class="footer-link">
<a href="http://poppro.cn/html/aboutus.html?hId=MQ==">关于POPPRO</a><span>|</span><a href="mailto:kfpoppro@scla.com.cn">联系我们</a><span>|</span><a href="http://poppro.cn/html/aboutus.html?hId=Mw==">用户条款</a><span>|</span><a href="mailto:bhpoppro@scla.com.cn">客服/版权申诉</a>
            <p>公司名称：上海新创华文化发展有限公司 | 公司地址：上海市静安区万荣路1053号6号楼 | 公司电话：(8621)51095308</p><p>&copy; Crypton Future Media, INC. www.piapro.net | 网站备案号：沪ICP备17015563号-1 | 网络文化经营许可证：沪网文（2017）11256-869号</p>
        </div>
    </div>
</div>
<div class="UED_hide" id="tip-upload">
    <div class="showbox showbox-2">
        <h2>缩略图</h2>
        <div class="uploadbox">
            <div class="imgcropperbox" style="height: 500px; margin: auto; width: 500px;">
                <img id="image" src="" style="width:100%">
                <input type="text" id="showcropperinfo" style="display: none">
            </div>
            <div class="btnbox">
            	<!-- <span style="color:grey; font-size:13px;">*滑动滚轴可调整图片大小</span><br><br> -->
                <!-- <a href="javascript:;" id="file_upload_pic">选择图片</a> --><a href="javascript:;" id="handleImg">确定裁剪</a>
            </div>
        </div>
    </div>
    <a class="tip-close" href="javascript:;"></a>
</div>
</body>
<script src="../js/jquery-1.7.1.min.js"></script>
<script src="../js/jquery.Jcrop.min.js"></script>
<!-- <script src="../js/util/jquery.uploadify.min.js"></script> -->
<script src="../js/dropkick.2.1.9.min.js"></script>
<script src="../js/util/jquery.uploadify.js"></script>
<script src="../js/jquery.uploadifive.min.js" type="text/javascript"></script>
<script src="/js/jq.layer.js"></script>
<script src="../js/layer/layer.js"></script>
<script src="../js/header.js"></script>
<script src="../js/project.js"></script>
<script src="../js/common.js"></script>
<script src="../js/page/work.js"></script>
<script>
	var jcrop_api;
	//类别
	getWorkCat(WORK_MUSIC,'catMusic');
    /*
     *  上传文件
     */
     $(function() {
    	 if (isUseH5()){
    		 $('#file_upload').hide();
    		 $('#file_upload_h5').show();
    		 $('#file_upload_h5').uploadifive({
 				'formData'     : {
 					'type' : 'music'
 				},
 				'uploadScript' : '/work/uploadmp3',
 				'color': 'blue',
 				'buttonText':'选择文件',
 				'fileType': 'audio/mpeg',
 				'height': 38,
                 'width': 116,
                 'buttonClass':'uploadbtn',
 				'multi' : false,
 				//'uploadLimit':1,
 				'queueSizeLimit':1,
 				'fileSizeLimit':'20000',
 				'removeCompleted':false,
 				'auto' : true,
 				'onUploadComplete': function (file, data, response) {
 					$('#SWFUpload_10_0').remove();//移除旧的
 					$('#uploadifive-file_upload_h5-queue .close').click();
				     var dataObj = JSON.parse(data);
				     $('.h5_file_name').text(file.name);
                    		 if(dataObj.code == 0){
                         	mp3File = dataObj.msg;
                         	mp3Length = dataObj.time;
                      	}else{
                      		alert(dataObj.msg);
                      	}
 				}
 			});
 			
    		 $('#file_upload_pic').hide();
    		 $('#file_upload_pic_h5').show();
 			  $('#file_upload_pic_h5').uploadifive({
 					'uploadScript' : '/work/upload'+'?sessionId='+cookie('sessionId')+'&Uploadtype='+queryString('type')+'&workId='+queryString('id'),
 					'color': 'blue',
 					'buttonText':'选择文件',
 					'fileType': ['image/jpeg','image/png','image/gif','image/jpg'],
 					'height': 38,
 		         	'width': 116,
 		         	'buttonClass':'uploadbtn1',
 					'multi' : false,
 					//'uploadLimit':1,
 					'queueSizeLimit':1,
 					'fileSizeLimit':'2000',
 					'auto' : true,
 					'onUploadComplete': function (file, data, response) {
 							$('#uploadifive-file_upload_pic_h5-queue .close').click();
 						     var dataObj = JSON.parse(data);
 						     var img = new Image();  
 		            		 if(dataObj.code == 0){
 		            			$.LAYER.show({id:'tip-upload'});
 		            			img.src = dataObj.msg;
 		            			img.onload = function(){
 		            				if (img.width > img.height) {
 		            					$('.imgcropperbox').html('<img id="image" style="width:100%" src="'+dataObj.msg+'">');
 		            				}
 		            				else {
 		            					$('.imgcropperbox').html('<img id="image" style="height:100%" src="'+dataObj.msg+'">');
 		            				}
 		            				$('#image').Jcrop({
 			            		      	bgFade:     true,
 			            		      	bgOpacity: .2,
 			            		     	allowResize:true,
 			            		      	/* aspectRatio: 150/200, */
 			            		      	onChange:getcord
 			            		    },function(){
 			            		      	jcrop_api = this;
 			            		      	jcrop_api.setSelect(['0','0','150','200'])
 			            		      	$('#handleImg').unbind('click');
 			            		      	$('#handleImg').click(function(){
 			            		    	  	console.log(jcrop_api.tellSelect());
 			            		    	  	console.log(jcrop_api.getWidgetSize());
 			            		    	  	var realInfo = jcrop_api.getWidgetSize();
 			            		    	  	var info = jcrop_api.tellSelect();
 			            		    	  	var percent_x = info.x/realInfo[0];
 			            		    	  	var percent_y = info.y/realInfo[1];
 			            		    	  	var percent_w = info.w/realInfo[0];
 			            		    	  	var percent_h = info.h/realInfo[1];
 			            		    	  	handleImg(dataObj.msg,percent_x,percent_y,percent_w,percent_h,1,function(r){
 			            		    	  		if (r.code == 0) {
 						                  			picSmall = r.picName;
 						                  			var newImg = new Image();
 						                  			newImg.src = picSmall;
 						                  			newImg.onload = function(){
 						                  				if (newImg.width > newImg.height) {
 						                  					$('.imgbox').html('<img style="width:100%" src='+r.picName+'>');
 							            				}
 							            				else {
 							            					$('.imgbox').html('<img style="height:100%" src='+r.picName+'>');
 							            				}
 						                  			}
 						                           	$.LAYER.close();
 						                  		}
 			            		    	  	})
 			                   		 	})
 			            		     });
 		            			}
 					        	
 			                 	/* picSmall = dataObj.msg;
 			                 	$('.imgbox').html('<img width="240" src="'+dataObj.msg+'">'); */
 		              		}else{
 		              			alert(dataObj.msg);
 		              		}
 					}
 				});
    	 }
    	 else {
    		 $('#file_upload').uploadify({
 				'formData'     : {
 					'type' : 'music'
 				},
 				'swf'      : '/swf/uploadify.swf',
 				'uploader' : '/work/uploadmp3',
 				'color': 'blue',
 				'buttonText':'选择文件',
 				'fileTypeExts': '*.mp3',
 				'height': 38,
                 'width': 116,
                 'buttonClass':'uploadbtn',
 				'multi' : false,
 				//'uploadLimit':1,
 				'queueSizeLimit':1,
 				'fileSizeLimit':'20000',
 				'removeCompleted':false,
 				'auto' : true,
 				'onUploadSuccess': function (file, data, response) {
 					$('#SWFUpload_10_0').remove();//移除旧的
 					     var dataObj = JSON.parse(data);
                    		 if(dataObj.code == 0){
                         	mp3File = dataObj.msg;
                         	mp3Length = dataObj.time;
                      	}else{
                      		alert(dataObj.msg);
                      	}
 				}
 			});
 			
 			  $('#file_upload_pic').uploadify({
 					'swf'      : '/swf/uploadify.swf',
 					'uploader' : '/work/upload',
 					'color': 'blue',
 					'buttonText':'选择文件',
 					'fileTypeExts': '*.jpg;*.jpeg;*.png;*.gif',
 					'height': 38,
 		         	'width': 116,
 		         	'buttonClass':'uploadbtn1',
 					'multi' : false,
 					//'uploadLimit':1,
 					'queueSizeLimit':1,
 					'fileSizeLimit':'2000',
 					'auto' : true,
 					'onUploadSuccess': function (file, data, response) {
 						     var dataObj = JSON.parse(data);
 						     var img = new Image();  
 		            		 if(dataObj.code == 0){
 		            			$.LAYER.show({id:'tip-upload'});
 		            			img.src = dataObj.msg;
 		            			img.onload = function(){
 		            				if (img.width > img.height) {
 		            					$('.imgcropperbox').html('<img id="image" style="width:100%" src="'+dataObj.msg+'">');
 		            				}
 		            				else {
 		            					$('.imgcropperbox').html('<img id="image" style="height:100%" src="'+dataObj.msg+'">');
 		            				}
 		            				$('#image').Jcrop({
 			            		      	bgFade:     true,
 			            		      	bgOpacity: .2,
 			            		     	allowResize:true,
 			            		      	/* aspectRatio: 150/200, */
 			            		      	onChange:getcord
 			            		    },function(){
 			            		      	jcrop_api = this;
 			            		      	jcrop_api.setSelect(['0','0','150','200'])
 			            		      	$('#handleImg').unbind('click');
 			            		      	$('#handleImg').click(function(){
 			            		    	  	console.log(jcrop_api.tellSelect());
 			            		    	  	console.log(jcrop_api.getWidgetSize());
 			            		    	  	var realInfo = jcrop_api.getWidgetSize();
 			            		    	  	var info = jcrop_api.tellSelect();
 			            		    	  	var percent_x = info.x/realInfo[0];
 			            		    	  	var percent_y = info.y/realInfo[1];
 			            		    	  	var percent_w = info.w/realInfo[0];
 			            		    	  	var percent_h = info.h/realInfo[1];
 			            		    	  	handleImg(dataObj.msg,percent_x,percent_y,percent_w,percent_h,1,function(r){
 			            		    	  		if (r.code == 0) {
 						                  			picSmall = r.picName;
 						                  			var newImg = new Image();
 						                  			newImg.src = picSmall;
 						                  			newImg.onload = function(){
 						                  				if (newImg.width > newImg.height) {
 						                  					$('.imgbox').html('<img style="width:100%" src='+r.picName+'>');
 							            				}
 							            				else {
 							            					$('.imgbox').html('<img style="height:100%" src='+r.picName+'>');
 							            				}
 						                  			}
 						                           	$.LAYER.close();
 						                  		}
 			            		    	  	})
 			                   		 	})
 			            		     });
 		            			}
 					        	
 			                 	/* picSmall = dataObj.msg;
 			                 	$('.imgbox').html('<img width="240" src="'+dataObj.msg+'">'); */
 		              		}else{
 		              			alert(dataObj.msg);
 		              		}
 					}
 				});
    	 }
			 

		 $(".tip-close").click(function(){
			 $.LAYER.close();
		 })

         $('#tab-1').click(function () {
             $('#tab-1,#tab-2').removeClass("on");
             $(this).addClass("on");

             $('#tabbox-1,#tabbox-2').hide();
             $('#tabbox-1').show();
         })
         $('#tab-2').click(function () {
             $('#tab-1,#tab-2').removeClass("on");
             $(this).addClass("on");

             $('#tabbox-1,#tabbox-2').hide();
             $('#tabbox-2').show();

         })

         $("#titlebox").bind("input propertychange",'textarea',function(){
             words_deal($(this),30,$('#titlebox-count'))
         });
		 
		 if(ac_type){
				var wordCount = 1000;
			}else{
				var wordCount = 500;
			}
			$('#descbox-count').html('<i>0</i>/1000');
			$("#textarea-1").bind("input propertychange",'textarea',function(){
		           words_deal($(this),wordCount,$('#descbox-count'))
            });

            $('#lyricbox-count').html('<i>0</i>/1000');
             $("#textarea-2").bind("input propertychange",'textarea',function(){
                 words_deal($(this),wordCount,$('#lyricbox-count'))
             });
    



         $('#selectbox-1').dropkick({
             change: function (value){
             }
         })

			
	});
     function getcord() {
	       /* console.log(jcrop_api.tellSelect())
	       console.log(jcrop_api.tellScaled())
	       console.log("===============================================") */ 
	 	};

    function words_deal(obj,maxnum,countobj)
    {
        var curLength=obj.val().length;

        console.log(curLength)
        if(curLength>=maxnum)
        {
            countobj.removeClass();
            countobj.addClass('txtmax');
            var num=obj.val().substr(0,maxnum);
            obj.val(num);
            //alert("超过字数限制，多出的字将被截断！" );
            countobj.find("i").html(maxnum)
        }else if(curLength<1){
            countobj.removeClass()
            countobj.find("i").html('0')
        }else
        {
            countobj.removeClass();
            countobj.addClass('txtmin')
            countobj.find("i").html(curLength)
        }
    }
    
    /*
     * 
     *
     */
     
     
    
</script>
</html>